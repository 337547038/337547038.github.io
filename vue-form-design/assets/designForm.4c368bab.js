var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable,d=(l,a,o)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:o}):l[a]=o,r=(e,l)=>{for(var a in l||(l={}))t.call(l,a)&&d(e,a,l[a]);if(o)for(var a of o(l))n.call(l,a)&&d(e,a,l[a]);return e},u=(e,o)=>l(e,a(o));import{_ as i,a as c,l as s,b as m}from"./vueFile.de12e12c.js";import{D as p,h as f,j as b,t as g,r as h,v as V,F as D,x as y,u as v,y as C,o as k,s as _,a as U,w,G as O,c as x,q as N,A as S,M as L,m as H,K as M,R as A,E as j,S as R,N as E,B as q}from"./vendor.bb6fcdfb.js";import{_ as T}from"./index.bdf2c4cb.js";import{a as F,b as J,s as z}from"./index.884f4285.js";const P=[{label:"label1",value:"value1"},{label:"label2",value:"value2"},{label:"label3",value:"value3"}],K={type:"fixed",source:0,request:"get",sourceFun:""};var B=[{title:"基础字段",children:[{type:"input",label:"单行文本",icon:"input",control:{modelValue:""},slot:{},config:{}},{type:"textarea",label:"多行文本",icon:"textarea",control:{modelValue:""},config:{}},{type:"radio",label:"单选框组",icon:"radio",control:{modelValue:""},options:P,config:K},{type:"checkbox",label:"多选框组",icon:"checkbox",control:{modelValue:[]},options:P,config:K},{type:"select",label:"下拉选择框",icon:"select",control:{modelValue:[],appendToBody:!0},options:P,config:K},{type:"datePicker",label:"日期选择器",icon:"date",control:{modelValue:"",type:"date"},config:{}},{type:"switch",label:"开关",icon:"switch",control:{modelValue:!1},config:{}},{type:"number",label:"计数器",icon:"number",control:{modelValue:""},config:{}},{type:"cascader",label:"级联选择器",icon:"cascader",control:{modelValue:[]},options:[],config:K},{type:"txt",label:"文字",icon:"text",control:{modelValue:""},config:{}},{type:"title",label:"标题",icon:"title",control:{modelValue:"标题"},config:{}}]},{title:"高级字段",children:[{type:"table",label:"子表",icon:"table",list:[],tableData:[],control:{border:!0},config:{}},{type:"component",label:"自定义组件",icon:"component",control:{modelValue:""},config:{},template:"",component:""},{type:"upload",label:"图片",icon:"image",control:{modelValue:[]},config:{}}]},{title:"布局字段",children:[{type:"grid",label:"格栅布局",icon:"grid",columns:[{attr:{span:12},list:[]},{attr:{span:12},list:[]}],control:{},config:{}},{type:"tabs",label:"标签页",icon:"tabs",columns:[{label:"Tab1",list:[]}],control:{},config:{}},{type:"card",label:"卡片布局",icon:"card",list:[],control:{},config:{},item:{}}]}];const I={name:"formControl",props:{formData:Object,searchData:Object,searchDesign:Boolean},components:{Draggable:p},setup(e){const l=f({selectValue:[]}),a=b((()=>e.searchDesign?B.slice(0,1):B)),o=b((()=>{const l=[];return n(e.formData,l),l})),t=["txt","title","table","component","upload"],n=(e,l)=>{e.forEach((e=>{"grid"===e.type||"tabs"===e.type?e.columns.forEach((e=>{n(e.list,l)})):"card"===e.type?n(e.list,l):-1===t.indexOf(e.type)&&l.push(e)}))};return u(r({controlList:a,selectChange:(l,a)=>{if(a){const a=JSON.parse(JSON.stringify(l));a.rules=[],a.customRules=[],e.searchData.list.push(a)}else e.searchData.list.forEach(((a,o)=>{a.name===l.name&&e.searchData.list.splice(o,1)}))},getCheckbox:l=>{let a=!1;return e.searchData.list.forEach((e=>{e.name===l&&(a=!0)})),a}},g(l)),{formDataList:o})}},$={class:"components-list"},W={class:"title"},G={key:0},Q=v("div",{class:"title"},"已有表单字段",-1),X={class:"content"};I.render=function(e,l,a,o,t,n){const d=h("draggable"),r=h("el-checkbox");return k(),V("div",$,[(k(!0),V(D,null,y(o.controlList,((e,l)=>(k(),V("div",{key:l},[v("div",W,_(e.title),1),U(d,{itemKey:"key123",tag:"ul",modelValue:e.children,"onUpdate:modelValue":l=>e.children=l,group:{name:"form",pull:"clone",put:!1},"ghost-class":"ghost",sort:!1},{item:w((({element:e})=>[v("li",{class:O([e.type])},[v("i",{class:O(`icon-${e.icon}`)},null,2),v("span",null,_(e.label),1)],2)])),_:2},1032,["modelValue","onUpdate:modelValue"])])))),128)),a.searchDesign?(k(),V("div",G,[Q,v("div",X,[(k(!0),V(D,null,y(o.formDataList,(e=>(k(),x(r,{key:e.name,checked:o.getCheckbox(e.name),onChange:l=>o.selectChange(e,l)},{default:w((()=>[N(_(e.item.label),1)])),_:2},1032,["checked","onChange"])))),128))])])):C("",!0)])};const Y={name:"formControlAttr",components:{},props:{formConfig:Object,linkageValue:Object},emits:["openDialog"],setup(e,{emit:l}){const a=S(),o=L(),t=o.query.formName,n=f({formAttr:[{label:"表单名称",value:"name"},{label:"表单标签宽度",value:"labelWidth"},{label:"表单样式名称",value:"class"},{label:"组件尺寸",value:"size",type:"select",options:[{label:"default",value:""},{label:"medium",value:"medium"},{label:"small",value:"small"},{label:"mini",value:"mini"}]}],dataSourceList:[],customRulesList:[{type:"required",label:"必填"},{type:"mobile",label:"手机号码"},{type:"tel",label:"固话"},{type:"phone",label:"固话或手机"},{type:"email",label:"邮箱"},{type:"int",label:"正整数"},{type:"number",label:"数字"},{type:"card",label:"身份证"},{type:"rules",label:"自定义正则"},{type:"methods",label:"自定义方法"}],searchDesign:"search"===o.query.type});t&&F(t).then((e=>{200===e.data.code&&(n.dataSourceList=e.data.data),n.loading=!1})).catch((e=>{console.log(e)}));const d=b((()=>a.state.form.controlAttr)),i=()=>{let e=d.value.control;"cascader"===d.value.type&&(e=d.value.options),l("openDialog",e,(e=>{"cascader"===d.value.type?d.value.options=e:(d.value.control={},Object.assign(d.value.control,e))}))},c=b((()=>{const e=d.value&&d.value.list;return!!(e&&e.length>0)&&"index"===e[0].typeColumn})),s=b((()=>{const e=d.value&&d.value.list;return!!(e&&e.length>0)&&"operate"===e[e.length-1].typeColumn})),m=b((()=>{const e=d.value&&d.value.rules;return e&&e.length>0}));return u(r({},g(n)),{controlData:d,delSelectOption:(e,l)=>{"tabs"===l?d.value.columns.splice(e,1):d.value.options.splice(e,1)},addSelectOption:e=>{"cascader"===d.value.type?i():"tabs"===e?d.value.columns.push({label:"标签名称",list:[]}):d.value.options.push({label:"",value:""})},openAttrDialog:i,selectMultipleChange:e=>{d.value.control.modelValue=e?[]:""},requiredChange:e=>{e?d.value.rules.push({required:!0,message:"必填项",trigger:"change"}):d.value.rules.splice(0,1)},addRules:()=>{l("openDialog",d.value.rules,(e=>{Object.assign(d.value.rules,e)}))},dataSourceChange:e=>{const l=n.dataSourceList.find((l=>l.COLUMN_NAME===e));d.value.item.label=l.COLUMN_COMMENT||l.COLUMN_NAME},showHide:(e,l)=>{if(e&&0===e.length||0===Object.keys(d.value).length)return!1;const a=e.indexOf(d.value.type);return l?-1!==a:-1===a},tableColumnAdd:(e,l)=>{const a={name:"",type:"tableColumn",typeColumn:l?"operate":"index",item:{label:l?"操作":"序号"},control:{type:l?"":"index"},config:{}};e?l?d.value.list.push(a):d.value.list.unshift(a):l?d.value.list.splice(d.value.list.length-1,1):d.value.list.splice(0,1)},columnIndex:c,columnOperate:s,checkboxRequired:m,addRulesFast:()=>{d.value.customRules&&d.value.customRules.push({type:"required",message:"",trigger:"blur"})},delAddRules:e=>{d.value.customRules&&d.value.customRules.splice(e,1)},rulesCommClick:()=>{l("openDialog",e.formConfig.rulesComm,(l=>{Object.assign(e.formConfig.rulesComm,l)}))}})}},Z={class:"sidebar-tools"},ee=v("h3",null,"通用属性",-1),le={key:7},ae=N("="),oe=N("序号列"),te=N("操作列"),ne=v("h3",null,"标签配置项",-1),de=["onClick"],re=N("增加标签"),ue={key:17},ie=v("h3",null,"选项配置",-1),ce={key:0},se=["onClick"],me=N("新增"),pe=N("数据源"),fe=N("方法函数"),be=v("h3",null,"校验设置",-1),ge={key:0},he=N("快速添加"),Ve=N("编辑校验规则"),De=N("必填 "),ye={key:20},ve=v("h3",null,"其他属性",-1),Ce=N("添加属性"),ke=N("编辑全局校验规则");Y.render=function(e,l,a,o,t,n){const d=h("el-input"),r=h("el-form-item"),u=h("el-option"),i=h("el-select"),c=h("el-switch"),s=h("el-checkbox"),m=h("el-col"),p=h("el-button"),f=h("el-tab-pane"),b=h("el-radio"),g=h("el-radio-group"),_=h("el-tabs"),O=h("el-form");return k(),V("div",Z,[U(_,{modelValue:"first"},{default:w((()=>[U(f,{label:"字段属性",name:"first"},{default:w((()=>[U(O,{size:"mini",class:"form"},{default:w((()=>[ee,U(r,{label:"自定义Class"},{default:w((()=>[U(d,{modelValue:o.controlData.className,"onUpdate:modelValue":l[0]||(l[0]=e=>o.controlData.className=e),placeholder:"样式类名"},null,8,["modelValue"])])),_:1}),o.showHide(["grid","tabs","card","title","gridChild","tableColumn"])?(k(),x(r,{key:0,label:"字段标识"},{default:w((()=>[e.dataSourceList&&e.dataSourceList.length>0?(k(),x(i,{key:0,modelValue:o.controlData.name,"onUpdate:modelValue":l[1]||(l[1]=e=>o.controlData.name=e),onChange:o.dataSourceChange},{default:w((()=>[(k(!0),V(D,null,y(e.dataSourceList,(e=>(k(),x(u,{key:e.COLUMN_NAME,label:`${e.COLUMN_COMMENT||e.COLUMN_NAME}(${e.COLUMN_NAME})`,value:e.COLUMN_NAME},null,8,["label","value"])))),128))])),_:1},8,["modelValue","onChange"])):(k(),x(d,{key:1,modelValue:o.controlData.name,"onUpdate:modelValue":l[2]||(l[2]=e=>o.controlData.name=e),placeholder:"字段唯一标识，对应数据库"},null,8,["modelValue"]))])),_:1})):C("",!0),o.showHide(["table","grid","tabs","title","gridChild"])?(k(),V(D,{key:1},[U(r,{label:"显示标题"},{default:w((()=>[U(d,{modelValue:o.controlData.item.label,"onUpdate:modelValue":l[3]||(l[3]=e=>o.controlData.item.label=e),placeholder:"显示的label标签名称"},null,8,["modelValue"])])),_:1}),o.showHide(["card"])?(k(),x(r,{key:0,label:"隐藏标签"},{default:w((()=>[U(c,{modelValue:o.controlData.item.showLabel,"onUpdate:modelValue":l[4]||(l[4]=e=>o.controlData.item.showLabel=e)},null,8,["modelValue"])])),_:1})):C("",!0),U(r,{label:"帮助信息"},{default:w((()=>[U(d,{modelValue:o.controlData.config.help,"onUpdate:modelValue":l[5]||(l[5]=e=>o.controlData.config.help=e)},null,8,["modelValue"])])),_:1})],64)):C("",!0),o.showHide(["table","grid","gridChild"])?(k(),x(r,{key:2,label:"表单栅格"},{default:w((()=>[U(d,{modelValue:o.controlData.config.span,"onUpdate:modelValue":l[6]||(l[6]=e=>o.controlData.config.span=e),placeholder:"表单区域栅格宽"},null,8,["modelValue"])])),_:1})):C("",!0),o.showHide(["input","textarea","select","date","number"],!0)?(k(),x(r,{key:3,label:"占位内容"},{default:w((()=>[U(d,{modelValue:o.controlData.control.placeholder,"onUpdate:modelValue":l[7]||(l[7]=e=>o.controlData.control.placeholder=e),placeholder:"placeholder"},null,8,["modelValue"])])),_:1})):C("",!0),o.showHide(["txt"],!0)?(k(),x(r,{key:4,label:"默认值"},{default:w((()=>[U(d,{modelValue:o.controlData.control.modelValue,"onUpdate:modelValue":l[8]||(l[8]=e=>o.controlData.control.modelValue=e),placeholder:"支持html",type:"textarea"},null,8,["modelValue"])])),_:1})):C("",!0),o.showHide(["input","password"],!0)?(k(),x(r,{key:5,label:"设为密码"},{default:w((()=>[U(i,{modelValue:o.controlData.type,"onUpdate:modelValue":l[9]||(l[9]=e=>o.controlData.type=e)},{default:w((()=>[U(u,{value:"input",label:"文本"}),U(u,{value:"password",label:"密码"})])),_:1},8,["modelValue"])])),_:1})):C("",!0),o.showHide(["textarea"],!0)?(k(),x(r,{key:6,label:"文本域高度"},{default:w((()=>[U(d,{modelValue:o.controlData.control.rows,"onUpdate:modelValue":l[10]||(l[10]=e=>o.controlData.control.rows=e),placeholder:"输入框行数"},null,8,["modelValue"])])),_:1})):C("",!0),o.showHide(["input"],!0)?(k(),V("div",le,[U(r,{label:"前缀"},{default:w((()=>[U(d,{modelValue:o.controlData.slot.prepend,"onUpdate:modelValue":l[11]||(l[11]=e=>o.controlData.slot.prepend=e)},null,8,["modelValue"])])),_:1}),U(r,{label:"后缀"},{default:w((()=>[U(d,{modelValue:o.controlData.slot.append,"onUpdate:modelValue":l[12]||(l[12]=e=>o.controlData.slot.append=e)},null,8,["modelValue"])])),_:1})])):C("",!0),o.showHide(["input","textarea","radio","checkbox","select","date","switch","number","cascader","upload"],!0)?(k(),x(r,{key:8,label:"操作属性"},{default:w((()=>[o.showHide(["select"],!0)?(k(),x(s,{key:0,modelValue:o.controlData.control.multiple,"onUpdate:modelValue":l[13]||(l[13]=e=>o.controlData.control.multiple=e),label:"多选",onChange:o.selectMultipleChange},null,8,["modelValue","onChange"])):C("",!0),o.showHide(["input","textarea","radio","checkbox","select","date","switch","number","cascader","upload"],!0)?(k(),x(s,{key:1,modelValue:o.controlData.control.disabled,"onUpdate:modelValue":l[14]||(l[14]=e=>o.controlData.control.disabled=e),label:"禁用"},null,8,["modelValue"])):C("",!0),U(s,{modelValue:o.controlData.config.editDisabled,"onUpdate:modelValue":l[15]||(l[15]=e=>o.controlData.config.editDisabled=e),label:"禁用编辑"},null,8,["modelValue"])])),_:1})):C("",!0),o.showHide(["input","textarea","radio","checkbox","select","date","switch","number","cascader"],!0)?(k(),x(r,{key:9,label:"联动条件"},{default:w((()=>[U(m,{span:9},{default:w((()=>[U(d,{placeholder:"标识名称",modelValue:o.controlData.config.linkKey,"onUpdate:modelValue":l[16]||(l[16]=e=>o.controlData.config.linkKey=e)},null,8,["modelValue"])])),_:1}),U(m,{span:2,offset:1},{default:w((()=>[ae])),_:1}),U(m,{span:9,offset:1},{default:w((()=>[U(d,{placeholder:"关联值",modelValue:o.controlData.config.linkValue,"onUpdate:modelValue":l[17]||(l[17]=e=>o.controlData.config.linkValue=e)},null,8,["modelValue"])])),_:1})])),_:1})):C("",!0),o.showHide(["grid"],!0)?(k(),V(D,{key:10},[],64)):C("",!0),o.showHide(["card"],!0)?(k(),V(D,{key:11},[],64)):C("",!0),o.showHide(["title"],!0)?(k(),x(r,{key:12,label:"标题"},{default:w((()=>[U(d,{modelValue:o.controlData.control.modelValue,"onUpdate:modelValue":l[18]||(l[18]=e=>o.controlData.control.modelValue=e)},null,8,["modelValue"])])),_:1})):C("",!0),o.showHide(["gridChild"],!0)?(k(),V(D,{key:13},[U(r,{label:"栅格占据的列数"},{default:w((()=>[U(d,{modelValue:o.controlData.attr.span,"onUpdate:modelValue":l[19]||(l[19]=e=>o.controlData.attr.span=e),modelModifiers:{number:!0}},null,8,["modelValue"])])),_:1}),U(r,{label:"栅格左侧的间隔格数"},{default:w((()=>[U(d,{modelValue:o.controlData.attr.offset,"onUpdate:modelValue":l[20]||(l[20]=e=>o.controlData.attr.offset=e),modelModifiers:{number:!0}},null,8,["modelValue"])])),_:1}),U(r,{label:"栅格向右移动格数"},{default:w((()=>[U(d,{modelValue:o.controlData.attr.push,"onUpdate:modelValue":l[21]||(l[21]=e=>o.controlData.attr.push=e),modelModifiers:{number:!0}},null,8,["modelValue"])])),_:1}),U(r,{label:"栅格向左移动格数"},{default:w((()=>[U(d,{modelValue:o.controlData.attr.pull,"onUpdate:modelValue":l[22]||(l[22]=e=>o.controlData.attr.pull=e),modelModifiers:{number:!0}},null,8,["modelValue"])])),_:1})],64)):C("",!0),o.showHide(["table"],!0)?(k(),x(r,{key:14,label:"添加列"},{default:w((()=>[U(s,{onChange:l[23]||(l[23]=e=>o.tableColumnAdd(e)),modelValue:o.columnIndex,"onUpdate:modelValue":l[24]||(l[24]=e=>o.columnIndex=e)},{default:w((()=>[oe])),_:1},8,["modelValue"]),U(s,{onChange:l[25]||(l[25]=e=>o.tableColumnAdd(e,1)),modelValue:o.columnOperate,"onUpdate:modelValue":l[26]||(l[26]=e=>o.columnOperate=e)},{default:w((()=>[te])),_:1},8,["modelValue"])])),_:1})):C("",!0),o.showHide(["tabs"],!0)?(k(),V(D,{key:15},[ne,(k(!0),V(D,null,y(o.controlData.columns,((e,l)=>(k(),x(r,{key:e.label},{default:w((()=>[U(m,{span:12},{default:w((()=>[U(d,{placeholder:"标签配置项",modelValue:e.label,"onUpdate:modelValue":l=>e.label=l},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),U(m,{span:2,offset:1},{default:w((()=>[v("i",{class:"icon-del",onClick:e=>o.delSelectOption(l,"tabs")},null,8,de)])),_:2},1024)])),_:2},1024)))),128)),U(r,null,{default:w((()=>[U(p,{onClick:l[27]||(l[27]=e=>o.addSelectOption("tabs"))},{default:w((()=>[re])),_:1})])),_:1})],64)):C("",!0),o.showHide(["component"],!0)?(k(),x(r,{key:16,label:"组件名"},{default:w((()=>[U(d,{modelValue:o.controlData.template,"onUpdate:modelValue":l[28]||(l[28]=e=>o.controlData.template=e),placeholder:"import进来的组件名称"},null,8,["modelValue"])])),_:1})):C("",!0),o.showHide(["radio","select","checkbox","cascader"],!0)?(k(),V("div",ue,[ie,U(_,{modelValue:o.controlData.config.type,"onUpdate:modelValue":l[32]||(l[32]=e=>o.controlData.config.type=e)},{default:w((()=>[U(f,{label:"固定选项",name:"fixed"},{default:w((()=>["cascader"!==o.controlData.type?(k(),V("div",ce,[(k(!0),V(D,null,y(o.controlData.options,((e,l)=>(k(),x(r,{key:l},{default:w((()=>[U(m,{span:10},{default:w((()=>[U(d,{placeholder:"选项标签",modelValue:e.label,"onUpdate:modelValue":l=>e.label=l},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),U(m,{span:10,offset:1},{default:w((()=>[U(d,{placeholder:"选项值",modelValue:e.value,"onUpdate:modelValue":l=>e.value=l},null,8,["modelValue","onUpdate:modelValue"])])),_:2},1024),U(m,{span:2,offset:1},{default:w((()=>[v("i",{class:"icon-del",onClick:e=>o.delSelectOption(l)},null,8,se)])),_:2},1024)])),_:2},1024)))),128))])):C("",!0),U(r,null,{default:w((()=>[U(p,{onClick:o.addSelectOption},{default:w((()=>[me])),_:1},8,["onClick"])])),_:1})])),_:1}),U(f,{label:"动态选项",name:"async"},{default:w((()=>[U(g,{modelValue:o.controlData.config.source,"onUpdate:modelValue":l[29]||(l[29]=e=>o.controlData.config.source=e)},{default:w((()=>[U(b,{label:0},{default:w((()=>[pe])),_:1}),U(b,{label:1},{default:w((()=>[fe])),_:1})])),_:1},8,["modelValue"]),U(r,null,{default:w((()=>[U(d,{modelValue:o.controlData.config.sourceFun,"onUpdate:modelValue":l[31]||(l[31]=e=>o.controlData.config.sourceFun=e),placeholder:o.controlData.config.source?"方法函数名":"数据源接口URL"},H({_:2},[o.controlData.config.source?void 0:{name:"prepend",fn:w((()=>[U(i,{modelValue:o.controlData.config.request,"onUpdate:modelValue":l[30]||(l[30]=e=>o.controlData.config.request=e),style:{width:"80px"}},{default:w((()=>[U(u,{label:"get",value:"get"}),U(u,{label:"post",value:"post"})])),_:1},8,["modelValue"])]))}]),1032,["modelValue","placeholder"])])),_:1})])),_:1})])),_:1},8,["modelValue"])])):C("",!0),o.showHide(["upload"],!0)?(k(),V(D,{key:18},[U(r,{label:"上传地址"},{default:w((()=>[U(d,{modelValue:o.controlData.control.action,"onUpdate:modelValue":l[33]||(l[33]=e=>o.controlData.control.action=e),placeholder:"图片上传地址"},null,8,["modelValue"])])),_:1}),U(r,{label:"文件字段名"},{default:w((()=>[U(d,{modelValue:o.controlData.control.name,"onUpdate:modelValue":l[34]||(l[34]=e=>o.controlData.control.name=e),placeholder:"上传的文件字段名"},null,8,["modelValue"])])),_:1}),U(r,{label:"列表类型"},{default:w((()=>[U(i,{modelValue:o.controlData.control.listType,"onUpdate:modelValue":l[35]||(l[35]=e=>o.controlData.control.listType=e)},{default:w((()=>[U(u,{value:"text"}),U(u,{value:"picture"}),U(u,{value:"picture-card"})])),_:1},8,["modelValue"])])),_:1}),U(r,{label:"提示文字"},{default:w((()=>[U(d,{modelValue:o.controlData.config.tip,"onUpdate:modelValue":l[36]||(l[36]=e=>o.controlData.config.tip=e),placeholder:"提示说明文字"},null,8,["modelValue"])])),_:1}),U(r,{label:"按钮文本"},{default:w((()=>[U(d,{modelValue:o.controlData.config.btnText,"onUpdate:modelValue":l[37]||(l[37]=e=>o.controlData.config.btnText=e),placeholder:"上传按钮文本"},null,8,["modelValue"])])),_:1})],64)):C("",!0),o.showHide(["txt","title","table","grid","tabs","card","switch","gridChild","tableColumn"])&&!e.searchDesign?(k(),V(D,{key:19},[be,o.showHide(["input","password","component"],!0)?(k(),V("div",ge,[a.formConfig.rulesComm&&a.formConfig.rulesComm.length>0?(k(),x(r,{key:0},{default:w((()=>[U(i,{placeholder:"快速选择",multiple:!0,modelValue:o.controlData.rulesComm,"onUpdate:modelValue":l[38]||(l[38]=e=>o.controlData.rulesComm=e)},{default:w((()=>[(k(!0),V(D,null,y(a.formConfig.rulesComm,(e=>(k(),x(u,{label:e.message,value:e.key,key:e.key},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})):C("",!0),(k(!0),V(D,null,y(o.controlData.customRules,((l,a)=>(k(),x(r,{key:l.type},{default:w((()=>[U(d,{modelValue:l.message,"onUpdate:modelValue":e=>l.message=e,placeholder:"校验提示信息"},{prepend:w((()=>[U(i,{modelValue:l.type,"onUpdate:modelValue":e=>l.type=e,style:{width:"80px"}},{default:w((()=>[(k(!0),V(D,null,y(e.customRulesList,(e=>(k(),x(u,{key:e.type,label:e.label,value:e.type},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),append:w((()=>[U(p,{icon:"icon-del",onClick:e=>o.delAddRules(a)},null,8,["onClick"])])),_:2},1032,["modelValue","onUpdate:modelValue"]),"rules"===l.type?(k(),x(d,{key:0,placeholder:"正则表达式",modelValue:l.rules,"onUpdate:modelValue":e=>l.rules=e},null,8,["modelValue","onUpdate:modelValue"])):C("",!0),"methods"===l.type?(k(),x(d,{key:1,placeholder:"方法名称",modelValue:l.methods,"onUpdate:modelValue":e=>l.methods=e},null,8,["modelValue","onUpdate:modelValue"])):C("",!0)])),_:2},1024)))),128)),U(r,null,{default:w((()=>[U(p,{onClick:o.addRulesFast},{default:w((()=>[he])),_:1},8,["onClick"]),U(p,{onClick:o.addRules},{default:w((()=>[Ve])),_:1},8,["onClick"])])),_:1})])):(k(),x(r,{key:1},{default:w((()=>[U(s,{modelValue:o.checkboxRequired,onChange:o.requiredChange},{default:w((()=>[De])),_:1},8,["modelValue","onChange"]),o.controlData.rules&&o.controlData.rules[0]?(k(),x(d,{key:0,placeholder:"自定义必填错误提示",modelValue:o.controlData.rules[0].message,"onUpdate:modelValue":l[39]||(l[39]=e=>o.controlData.rules[0].message=e)},null,8,["modelValue"])):C("",!0)])),_:1}))],64)):C("",!0),o.showHide(["grid","card","gridChild"])?(k(),V("div",ye,[ve,U(p,{size:"mini",onClick:o.openAttrDialog},{default:w((()=>[Ce])),_:1},8,["onClick"])])):C("",!0)])),_:1})])),_:1}),U(f,{label:"表单属性",name:"second"},{default:w((()=>[U(O,{size:"mini",class:"form"},{default:w((()=>[(k(!0),V(D,null,y(e.formAttr,((e,l)=>(k(),x(r,{label:e.label,key:l},{default:w((()=>["select"===e.type?(k(),x(i,{key:0,modelValue:a.formConfig[e.value],"onUpdate:modelValue":l=>a.formConfig[e.value]=l},{default:w((()=>[(k(!0),V(D,null,y(e.options,(e=>(k(),x(u,{label:e.label,key:e.label,value:e.value},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])):(k(),x(d,{key:1,modelValue:a.formConfig[e.value],"onUpdate:modelValue":l=>a.formConfig[e.value]=l,placeholder:e.placeholder},null,8,["modelValue","onUpdate:modelValue","placeholder"]))])),_:2},1032,["label"])))),128)),U(r,null,{default:w((()=>[U(p,{onClick:o.rulesCommClick},{default:w((()=>[ke])),_:1},8,["onClick"])])),_:1})])),_:1})])),_:1})])),_:1})])};const _e={name:"designIndex",components:{headTools:i,formControl:I,formDesign:T,formControlAttr:Y,vueFile:c},setup(e,{emit:l}){const a=S(),o=L().query,t=f({formData:{list:[],config:{labelWidth:"",class:"",size:"medium",name:"form"+(new Date).getTime(),rulesComm:[]}},visibleDialog:!1,sourceDialog:"",editor:{},loading:!1,drawerDirection:"rtl",formDataPreview:{},previewVisible:!1,searchDesign:"search"===o.type,formDataList:[]}),n=M(),d=o.id,i=o.formName;if(d&&(t.loading=!0,J(d).then((e=>{if(200===e.data.code)if(t.searchDesign){const l=e.data.data[0].searchData;t.formData=l?JSON.parse(l):[],t.formDataList=JSON.parse(e.data.data[0].formData).list}else t.formData=JSON.parse(e.data.data[0].formData);t.loading=!1})).catch((e=>{console.log(e),t.loading=!1}))),!d&&!i){const e=s();e&&(t.searchDesign?(e.searchData&&(t.formData=e.searchData),e.formData&&(t.formDataList=e.formData.list)):e.formData&&(t.formData=e.formData))}const c=()=>{const e=JSON.stringify(t.formData),l=t.searchDesign?"searchData":"formData";if(i){let a={formData:e,id:o.id,formName:t.formData.config.name,dataTableName:i};t.searchDesign&&(a={searchData:e,id:o.id}),t.loading=!0,z(a).then((e=>{200===e.data.code?j({message:"保存成功！",type:"success"}):j.error(e.data.message),t.loading=!1})).catch((e=>{s(l,t.formData),j.info("请求异常，数据已暂存在localStorage"),t.loading=!1}))}else s(l,t.formData),j.info("数据已暂存在localStorage");a.commit("setActiveKey",""),a.commit("setControlAttr",{})},p=(e,l)=>{t.drawerDirection=l?"ltr":"rtl",t.sourceDialog=l,t.visibleDialog=!0;const a=JSON.stringify(e,null,2);R((()=>{t.editor=m(a)}))},b=()=>{t.visibleDialog=!1,t.sourceDialog=""},h=M();return A((()=>{0!==Object.keys(t.editor).length&&(t.editor.destroy(),t.editor.container.remove())})),u(r({},g(t)),{headToolClick:e=>{switch(t.sourceDialog="",e){case"del":t.formData.list=[],t.formData.config.rulesComm=[],a.commit("setActiveKey",""),a.commit("setControlAttr",{});break;case"eye":t.formDataPreview=JSON.parse(JSON.stringify(t.formData)),t.previewVisible=!0;break;case"json":p(t.formData);break;case"save":c();break;case"vue":n.value.open(t.formData);break;case"import":p({})}},dialogConfirm:()=>{const e=JSON.parse(t.editor.getValue());t.sourceDialog?t.sourceDialog(e):t.formData=e,t.visibleDialog=!1},dialogOpen:p,drawerBeforeClose:e=>{b(),e()},dialogCancel:b,vueFileEl:n,previewForm:h,previewSubmit:()=>{h.value.validate((e=>{if(!e)return alert("校验不通过"),!1;alert("校验通过")}))}})}},Ue={class:"container"},we={class:"main-body"},Oe={key:0,class:"empty-tips"},xe={class:"main-form"},Ne={key:0,id:"editJson"},Se={class:"dialog-footer"},Le=N(" 确定 "),He={class:"dialog-footer"},Me=N(" 提交 "),Ae=N(" 取消 ");_e.render=function(e,l,a,o,t,n){const d=h("formControl"),r=h("headTools"),u=h("form-design"),i=h("form-control-attr"),c=h("el-button"),s=h("el-drawer"),m=h("vue-File"),p=h("el-dialog"),f=E("loading");return k(),V("div",Ue,[U(d,{formData:e.formDataList,searchData:e.formData,searchDesign:e.searchDesign},null,8,["formData","searchData","searchDesign"]),v("div",we,[U(r,{onClick:o.headToolClick},null,8,["onClick"]),0===e.formData.list.length?(k(),V("div",Oe," 从左侧拖拽来添加字段 ")):C("",!0),q(v("div",xe,[U(u,{"form-data":e.formData,type:4},null,8,["form-data"])],512),[[f,e.loading]])]),U(i,{formConfig:e.formData.config,onOpenDialog:o.dialogOpen},null,8,["formConfig","onOpenDialog"]),U(s,{modelValue:e.visibleDialog,"onUpdate:modelValue":l[0]||(l[0]=l=>e.visibleDialog=l),size:"60%",direction:e.drawerDirection,"custom-class":"json-dialog","append-to-body":!0,"before-close":o.drawerBeforeClose},{default:w((()=>[e.visibleDialog?(k(),V("div",Ne)):C("",!0),v("div",Se,[U(c,{type:"primary",size:"small",onClick:o.dialogConfirm},{default:w((()=>[Le])),_:1},8,["onClick"])])])),_:1},8,["modelValue","direction","before-close"]),e.searchDesign?C("",!0):(k(),x(m,{key:0,ref:"vueFileEl"},null,512)),U(p,{modelValue:e.previewVisible,"onUpdate:modelValue":l[2]||(l[2]=l=>e.previewVisible=l),title:"预览",fullscreen:!0},{footer:w((()=>[v("div",He,[U(c,{size:"small",type:"primary",onClick:o.previewSubmit},{default:w((()=>[Me])),_:1},8,["onClick"]),U(c,{size:"small",onClick:l[1]||(l[1]=l=>e.previewVisible=!1)},{default:w((()=>[Ae])),_:1})])])),default:w((()=>[U(u,{"form-data":e.formDataPreview,type:1,ref:"previewForm"},null,8,["form-data"])])),_:1},8,["modelValue"])])};export{_e as default};
